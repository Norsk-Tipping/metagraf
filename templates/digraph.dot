digraph {
  rankdir=tplr
  node [color=grey25,
        fillcolor=wheat,
        shape=box,
        style="rounded,filled"];
{{ range $mg := . -}}
{{ range $mg.Spec.Resources -}}
"{{.Name}}{{if .Semver}}-v{{.Semver}}{{end}}" [
{{- if eq .Type "datasource" }}
shape=cylinder,fillcolor=lightskyblue
{{- else }}
  {{- if eq .Type "function" }}
shape=hexagon,fillcolor=darkseagreen
  {{- end }}
{{end}}]
"{{ $mg.Metadata.Name}}-v{{$mg.Spec.Version}}" -> "{{ .Name }}{{if .Semver}}-v{{.Semver}}{{end}}"
{{ end -}}
{{ end -}}
}